<ion-header>
    <ion-toolbar>
        <ion-buttons start>
            <button ion-button (click)="onCinemaChange($event)" class="cinemas-popover">
                {{(cinema$ | async)?.nameShort}}
            </button>
        </ion-buttons>
        <ion-segment [(ngModel)]="filter" color="primary" (ionChange)="onFilterChange()">
            <ion-segment-button value="today">
                Today
            </ion-segment-button>
            <ion-segment-button value="future">
                Comming Soon 
            </ion-segment-button>
        </ion-segment>
    </ion-toolbar> 
</ion-header>

<ion-content padding class="page-content" [ngClass]="{'loading': (loading$ | async)}">

    <ng-container *ngIf="(loading$ | async) == true"> 
        <div class="movies current">
            <div *ngFor="let i of [1, 2, 3, 4]" class="movie-detail loading">
                <div class="poster">
                    <div class="content">
                    </div>
                </div>
                <div class="item-content">
                    <span class="title">&nbsp;</span>
                    <span class="country">&nbsp;</span>
                    <span class="genre ">&nbsp;</span>
                    <span class="line"> 
                        <span class="date">&nbsp;</span>
                    <span class="time">&nbsp;</span>
                    </span>
                </div>
            </div>
        </div>
    </ng-container>

    <ng-container *ngIf="(loading$ | async) == false">
        <ng-container [ngSwitch]="filter">
            <div *ngSwitchCase="'today'" class="movies current">
                <div *ngFor="let movie of current$ | async" class="movie-detail" (tap)="openMovie(movie)">
                    <div class="poster">
                        <div class="content">
                            <img src="{{movie.poster}}">
                        </div>
                    </div>
                    <div class="item-content">
                        <span class="title">{{movie.name}}</span>
                        <span class="country">{{movie.countries | join: ", "}}</span>
                        <span class="genre ">{{movie.genres | join:" | "}}</span>
                        <span class="line"> 
                        <span class="date">{{movie.sinceDate | date:"yMMMd"}}</span>
                        <span class="time">{{duration(movie.duration)}}</span>
                        </span>
                        <!-- services rating -->
                        <div class="ratings" *ngIf="movie.ratings != null">
                            <div class="imdb" *ngIf="movie.ratings.imdb != null">
                                <span>imdb <span class="nb">{{movie.ratings.imdb.rating}}</span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngSwitchCase="'future'" class="movies future">
                <div *ngFor="let movie of future$ | async" class="movie-icon future" (tap)="openMovie(movie)">
                    <div class="poster">
                        <div class="content">
                            <img src="{{movie.poster}}">
                        </div>
                    </div>
                    <div class="title">{{movie.name}}</div>
                </div>
            </div>
        </ng-container>
    </ng-container>

</ion-content>